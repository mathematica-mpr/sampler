<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Bayesed and confused</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alex, Constance, Max, Phil" />
    <meta name="date" content="2019-08-22" />
    <link href="BayesedandConfused_conference_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="BayesedandConfused_conference_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Bayesed and confused
### Alex, Constance, Max, Phil
### 2019-08-22

---

#  About Mathematica 

+ Established in 1968
+ We are the insight partner that illuminates the path to progress for public and private sector changemakers .
+ 1,200+ employees
+ Our experts dive into urgent social challenges with rigor and objectivity to surface evidence and understanding that weathers the toughest tests.
+ **Employee-owned since 1986**
+ Reimagining the way the world gathers and uses data, we uncover the evidence that offers our partners the confidence and clarity they need to find out what can be done, how to make it happen, and where to go next.


---
#  Our Office Locations 


![](assets/img/image11.png)

---
#  Data Science at Mathematica 

+ Remote, virtual community of 40+ staff
	+ Born out of statistics
+ Primarily concentrated in healthcare
+ Close connections to data engineers, researchers, and developers
+ What defines the community?
	+ Training (tooling, methods, reproducible research)
	+ User groups and chatrooms
	+ Knowledge management
	+ Data acquisition
	+ Strategic investments
[Born out of statistics](https://amstat.tandfonline.com/doi/full/10.1080/00031305.2016.1255256#.XVwBX-hKiUk)

---
#  Agenda 

+ Background
+ How it works in theory
+ How it works in practice
+ Demo
+ Concluding remarks &amp; next steps

---
#  Background 


---
#  Confusion matrix 

+ Machine learning algorithms used to predict binary outcomes rely on the confusion matrix to compare and validate models

![](assets/img/matrix.png)

---
#  Application to ethics 

+ Work by Mitchell et al. suggests the use of an augmented confusion matrix to assess algorithmic fairness by comparing metric performance across groups

![](assets/img/augmatrix.png)

---
#  Motivating example 

+ COMPAS
	+ C orrectional O ffender M anagement P rofiling for A lternative S anctions
	+ Tool to help judges, probation and parole officers assess a criminal defendant?s likelihood to re-offend (recidivism)
+ ProPublica analysis
	+ Study of 10,000 criminal records in the state of Florida
	+ Compared predicted recidivism rate to actual recidivism rate of defendants
	+ Showed  it disproportionally incorrectly flag black defendants compared to white defendants

---
#  How to assess unfairness of COMPAS 

+ Compare rates between two subgroups: black and white defendants
+ COMPAS claims rates between groups match
	+ Positive Predicted Value (PPV) = accurate classification as higher risk
	+ Negative Predicted Value (NPV) = accurate classification as lower risk
+ ProPublica claims rates between groups do not match
	+ False Negative Rates (FNR) = misclassification as lower risk
	+ False Positive Rates (FPR) = misclassification as higher risk

---
#  How certain are we that an algorithm is unfair? 

+ Current applications of confusion matrix approach to assessing fairness ignore uncertainty
+ Potential problems
	+ Small sample sizes
		+ Results for small sample sizes are inherently more uncertain than for larger sample sizes
	+ Low prevalence
		+ It can be especially tricky to assess performance of an algorithm that handles events with a low prevalence

---
#  Our contribution 

+ Framework for assessing algorithmic fairness with uncertainty
+ Builds on work from Mitchell et al. on augmented confusion matrix for AI fairness
+ Free, automated tool that is customizable to your data
+ Built on AWS, powered by Bayesian-flavored Monte Carlo models

---
#  How it works in theory 


---
#  Overview 

![](assets/img/overview.png)

---


# Architecture

![](assets/img/architecture.png)

---
#  The models 

+ Our method takes a sample from our two Poisson distributions, feeds them in the Beta distribution, and takes a sample from this distribution.
+ We repeat this process in its entirety for each sample from the Beta distribution, so that the Beta distribution gets re-defined entirely with every draw.
+ We then build a distribution with each of our Beta samples.

![](assets/img/model.png)

---
#  How it works in practice 


---
#  User input 

+ **Population** refers to the general population.
	+ This is not necesarily a sample.
+ **Prevalence** is the prevalence of the condition in the general population.
	+ Similarly to the population, this number can be different than the prevalence in the sample you used in your study.
+ The values in the **confusion matrix (true positive, false positive, false negative and true negative)**
	+ This should come from the sample you used in your study.
![](assets/img/input.png)

---
#  Output 

+ Distribution around the initial values provided
+ Description of metric triggered by mouse hover
+ Performance metrics produced by app
![](assets/img/output.png)

---
#  Demo 


---
#  COMPAS 

![](assets/img/table.png)


---
#  Demo! 

+ http://www.ethics-mathematica.com/
[http://www.ethics-mathematica.com/](http://www.ethics-mathematica.com/)

---
#  Black defendants 


![](assets/img/black.png)

---
#  White defendants 


![](assets/img/white.png)

---
#  Summary 

+ FNR
	+ ProPublica suggests white defendants who did get rearrested were nearly twice as likely to be misclassified as low risk
	+ Face validity: app shows bias (W: 0.371 ; B:0.220) but shows a less drastic difference
+ FPR
	+ ProPublica suggests black defendants who did not get rearrested were nearly twice as likely to be misclassified as higher risk
	+ Face validity: app shows bias ( W: 0.735 ; B: 0.99) but shows a less drastic difference
+ PPV
	+ COMPAS argues that their algorithm satisfied calibration, which is similar to equal PPV and equal NPV
	+ Face validity: app confirms the similarities between the two groups on this metric
		+ PPV (W: 0.690 ; B: 0.616)
		+ NPV (W: 0.384 ; B: 0.336)

---
#  Next steps &amp; concluding remarks 


---
#  Next steps 

+ Application to other topics
+ Storyboard
+ Relaxing distributional assumptions
+ Testing edge cases

---
#  Conclusion 

+ Free, open-source tool for AI ethics
+ Bayesian flavor provides uncertainty estimates
+ Feedback welcome!
	+ abohl@mathematica-mpr.com
	+ Github
		+ Mathematica- mpr /sampler
		+ Mathematica- mpr /sampler-spa
		+ Mathematica- mpr /sampler- api
[abohl@mathematica-mpr.com](https://github.com/mathematica-mpr/sampler)
[Mathematica-](mailto:abohl@mathematica-mpr.com)
[mpr](https://github.com/mathematica-mpr/sampler-api)
[/sampler](https://github.com/mathematica-mpr/sampler-spa)
[Mathematica-](https://github.com/mathematica-mpr/sampler)
[mpr](mailto:abohl@mathematica-mpr.com)
[/sampler-spa](https://github.com/mathematica-mpr/sampler-api)
[Mathematica-](https://github.com/mathematica-mpr/sampler-spa)
[mpr](https://github.com/mathematica-mpr/sampler)
[/sampler-](mailto:abohl@mathematica-mpr.com)
[api](https://github.com/mathematica-mpr/sampler-api)

---
#  Additional info 


---
#  References	 

+ Fairness in AI
+  Mitchell et al .
+  Reflections on Quantitative Fairness
+ COMPAS study
	+ ProPublica?s main article 
	+ ProPublica?s detailed article
	+ ProPublica?s  Github
[Mitchell et al.](https://arxiv.org/pdf/1811.07867v2.pdf)
[Reflections on Quantitative Fairness](https://shiraamitchell.github.io/fairness)
[ProPublica's main article](https://www.propublica.org/article/machine-bias-risk-assessments-in-criminal-sentencing)
[ProPublica's detailed article](https://www.propublica.org/article/how-we-analyzed-the-compas-recidivism-algorithm)
[ProPublica's Github](https://github.com/propublica/compas-analysis)

---
#  Model 



---
#  The model(s) 

+ A Beta distribution that provides the probability of true positives, true negatives, false negatives and false positives in our population.
+ This Beta distribution takes two parameters, alpha and beta, which signify the number of ?successes? and ?failures?, respectively.
+ This distribution is centered around values of alpha and beta for each pane of the confusion matrix.
+ For example, the distribution of true positives will be centered around the fraction of true positives to false negatives.
+ with our probability with mean
+ For the distribution of true positives, we would have:

![](assets/img/moremodel1.png)
---
#  The model(s) 

+ Each parameter of the Beta distribution has a Poisson prior.
+ The Poisson distribution is centered around a mean provided by the input values of alpha and beta.
+ For the distribution of true positives, we would have:

![](assets/img/moremodel2.png)

---
#  The model(s) 

+ Now that we our Beta distribution defined, and pinned by our two Poisson priors, we can start sampling!
+ Our method takes a sample from our two Poisson distributions, feeds them in the Beta distribution, and takes a sample from this distribution.
+ We repeat this process in its entirety for each sample from the Beta distribution, so that the Beta distribution gets re-defined entirely with every draw.
+ We then build a distribution with each of our Beta samples.

![](assets/img/model.png)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
